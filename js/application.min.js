var myApp=angular.module("mobileWebApp",["ngRoute","ui.bootstrap","ngResource","ngAnimate","LocalStorageModule"]);myApp.config(["$routeProvider","localStorageServiceProvider",function(e,t){e.when("/phones",{templateUrl:"views/phones.html",controller:"PhoneCtrl"}).when("/plans",{templateUrl:"views/plans.html",controller:"PlansCtrl"}).when("/cart",{templateUrl:"views/cart.html",controller:"CartCtrl"}).when("/",{templateUrl:"views/home.html",controller:"HomeCtrl"}).otherwise({redirectTo:"/"}),t.setPrefix("myApp")}]),myApp.service("myAppCart",["localStorageService",function(e){return{addItemToCart:function(t,r){var o=e.get("cart")||[];o.push({item:t,cost:r}),e.set("cart",o)},removeItemFromCart:function(t,r){var o=e.get("cart")||[],n=-1;if(r>=0)n=r;else for(i=0;i<o.length;i++)if(o[i].item==t){n=i;break}return n>-1&&(o.splice(n,1),e.set("cart",o)),o},checkCartForItem:function(t){var r=e.get("cart")||[];for(i=0;i<r.length;i++)if(r[i].item==t)return!0;return!1},clearCart:function(){return console.log("Clear Cart"),e.remove("cart"),this.getCart()},getCart:function(){return e.get("cart")||[]},setCart:function(t){e.set("cart",t)}}}]),myApp.factory("phoneFactory",["$resource",function(e){return e("data/phones.json",{},{get:{method:"GET",params:{},isArray:!0}})}]),myApp.service("phoneDataService",function(){return{phoneDataArray:[],phoneSlideInfo:[]}}),myApp.factory("planFactory",["$resource",function(e){return e("data/plans.json",{},{get:{method:"GET",params:{},isArray:!0}})}]),myApp.service("planDataService",function(){return{planData:[]}}),myApp.controller("HomeCtrl",["$scope","phoneFactory","phoneDataService",function(e,t,r){function o(e){for(var t=0,r=l.length;t<r;t++)l[t].slide_id=e.pop()}function n(){for(var e=[],t=0;t<i;++t)e[t]=t;return a(e)}function a(e){var t,r,o=e.length;if(o)for(;--o;)t=e[r=Math.floor(Math.random()*(o+1))],e[r]=e[o],e[o]=t;return console.log("shuffling. Array is now: "+e),e}console.log("phoneDataArray? %O",r.phoneDataArray),e.interval=5e3,e.noWrapSlides=!1,e.active=0;var i=0;if(e.addSlide=function(){var e=i;e>r.phoneDataArray.length-1&&(e=Math.floor(Math.random()*r.phoneDataArray.length)),l.push({url:r.phoneDataArray[e].url,img:r.phoneDataArray[e].img,text:r.phoneDataArray[e].title,slide_id:r.phoneDataArray[e].id,slide_index:i++})},e.popSlideInfo=function(){for(var t=0;t<r.phoneDataArray.length;t++)e.addSlide();r.phoneSlideInfo=e.slides},0==r.phoneDataArray.length){console.log("first run, no phone data - pull from file via phoneFactory and populate data and slides in phoneDataService service");l=e.slides=[];t.get(function(t){r.phoneDataArray=t,e.popSlideInfo()})}else if(0==r.phoneSlideInfo.length){console.log("We have phone data, but no slide info - add slides to phoneDataService service");l=e.slides=[];e.popSlideInfo()}else{console.log("We have phone and slide info. Get slides from phoneDataService service.");var l=e.slides=r.phoneSlideInfo;i=l.length}e.randomize=function(){o(n())},console.log("Home controller initialized.")}]),myApp.controller("PhoneCtrl",["$scope","phoneFactory","phoneDataService",function(e,t,r){if(console.log("Phone controller initialized"),console.log("phone info? %O",r.phoneDataArray),0==r.phoneDataArray.length)t.get(function(t){r.phoneDataArray=t;var o=e.phones=r.phoneDataArray;console.log("getting phoneData as phones: %O",o)});else e.phones=r.phoneDataArray}]),myApp.controller("PlansCtrl",["$scope","planFactory","planDataService","$document",function(e,t,r,o){console.log("Plans controller initialized"),0==r.planData.length?(console.log("No Plan data, getting from file"),t.get(function(t){e.plans=t,r.planData=t})):(console.log("Got Plan data, retrieve from service"),e.plans=r.planData)}]),myApp.controller("CartCtrl",["$scope","myAppCart",function(e,t){e.cart=t.getCart(),console.log("Cart controller initialized. Cart is: %O",e.cart),e.removeItemFromCart=function(r,o){e.cart=t.removeItemFromCart(r,o)},e.clearCart=function(){e.cart=t.clearCart()}}]),myApp.directive("activeLink",["$location",function(e){return{restrict:"A",link:function(t,r){console.log("element: %0",r),t.location=e;var o=r[0].hash.substring(2);t.$watch("location.path()",function(e,t){console.log("path change: old - "+t+" - new: "+e);var n=e.substring(1);o===n?r.parent().addClass("active-item"):r.parent().removeClass("active-item")})}}}]),myApp.directive("cartButtons",["myAppCart",function(e){return{templateUrl:"views/cart-buttons.html",transclude:!0,scope:{id:"=id",price:"=price"},restrict:"AE",link:function(t,r){t.addItemToCart=function(){e.addItemToCart(t.id,t.price)},t.checkCartForItem=function(){return e.checkCartForItem(t.id)},t.removeItemFromCart=function(){e.removeItemFromCart(t.id)}}}}]);